<form action="index.cgi?show=list" method="post" id="form">
<input type="hidden" name="show" value="list" />
<input type="hidden" id="do" name="do" value="" />

<div id="list">
    <table class="list" summary="[% gettext('Main torrents list') %]">
    <colgroup>
        <col width="1%"/>
        <col width="26px"/>
        <col width="47%"/>
        <col width="24px"/>
        <col width="24px"/>
        <col width="24px"/>
        <col width="24px"/>
        <col width="24px"/>
        <col width="24px"/>
        <col width="5%"/>
        <col width="10%"/>
        <col width="10%"/>
        <col width="5%"/>
        <col width="5%"/>
        <col width="5%"/>
        <col width="5%"/>
        <col width="5%"/>
    </colgroup>
    <thead>
        <tr>
            <th>
                <input type="checkbox" class="all" id="all"
                    [% IF data.all == 'true' %]checked="checked"[% END %]
                    title="[% gettext('Select/Unselect all') %]"
                 />
            </th>
            [%
                SET max_custom = data.list.list.0.custom_count;
            %]
            <th abbr="[% gettext('Nm') %]" colspan="[% 3 + max_custom - 1 %]">
                [% gettext('Name') %]
            </th>
            <th abbr="[% gettext('Pr') %]">[% gettext('Priority')   %]</th>
            <th abbr="[% gettext('Sz') %]">[% gettext('Size')       %]</th>
            <th abbr="[% gettext('Dn') %]">[% gettext('Done')       %]</th>
            <th abbr="[% gettext('St') %]">[% gettext('Status')     %]</th>
            <th abbr="[% gettext('Pe') %]">[% gettext('Peers')      %]</th>
            <th abbr="[% gettext('DS') %]">[% gettext('Down Speed') %]</th>
            <th abbr="[% gettext('US') %]">[% gettext('Up Speed')   %]</th>
            <th abbr="[% gettext('Rt') %]">[% gettext('Rate')       %]</th>
        </tr>
    </thead>

    <tbody>
    [% FOR torrent = data.list.list %]
        [%
            SET class = [];
            IF loop.index % 2; class.push('odd'); ELSE; class.push('even'); END;
            IF data.current == torrent.hash; class.push('selected'); END;
            UNLESS torrent.is_active; class.push('inactive'); END;
        %]
            <tr class="[% class.join(' ') %]">
                <td class="select">
                    <input
                        [% IF data.hash.${torrent.hash} %]
                            checked="checked"
                        [% END %]
                        type="checkbox"
                        name="hash[]"
                        value="[% torrent.hash %]"/>
                </td>
                <td class="img">
                    [% IF torrent.hashing %]<div class="img hashing"/>
                    [% ELSIF torrent.complete %]
                        [% IF torrent.is_active %]<div class="img seeding"/>
                        [% ELSE %]<div class="img seeding_inactive"/>
                        [% END %]
                    [% ELSE %]
                        [% IF torrent.is_active %]<div class="img downloading"/>
                        [% ELSE %]<div class="img downloading_inactive"/>
                        [% END %]
                    [% END %]
                </td>
                [%
                    SET custom_count    = 0;
                    SET customs         = [1.. max_custom];
                    FOR num IN customs;
                        SET c = 'custom' _ num;
                        IF torrent.${c};
                            custom_count = custom_count + 1;
                        END;
                    END;
                %]
                <td class="name" colspan="[% max_custom - custom_count %]">
                    [% torrent.name %]
                </td>
                [%
                    FOR num IN customs;
                        SET c = 'custom' _ num;
                        IF torrent.${c};
                            SET class = ['custom'];
                            class.push('c' _ num);
                %]
                    <td class="[% class.join(' ') %]"
                        title="[%
                            gettext('Custom') _ ' ' _ num _ ': ' _
                            torrent.${c}
                        %]"/>
                [%      END;
                    END;
                %]
                <td
                    [%
                        SET class = ['message'];
                        IF torrent.message; class.push('warning'); END;
                    %]
                    class="[% class.join(' ') %]"
                    [% IF torrent.message %]
                        title="[% torrent.message %]"
                    [% END %]
                />
                <td class="num info">[% gettext(torrent.priority_str) %]</td>
                <td class="size digit">
                    [% torrent.size_bytes.as_human_size %]
                    <span class="data">[% torrent.size_bytes %]</span>
                </td>
                <td class="done info">
                    [% torrent.percent %]
                    <div class="indicator">
                        <div class="percent"
                            style="width: [% torrent.percent %];" />
                    </div>
                </td>
                <td class="status info">
                    [%
                        IF torrent.hashing;         gettext('Hashing');
                        ELSIF torrent.complete;
                            IF torrent.is_active;   gettext('Seeding');
                            ELSE;                   gettext('Finished');
                            END;
                        ELSE;
                            IF torrent.is_active;   gettext('Downloading');
                            ELSE;                   gettext('Paused');
                            END;
                        END;
                    %]
                </td>
                <td class="peers digit">[% torrent.peers_connected %]</td>
                <td class="down_speed digit">
                    [% torrent.down_rate.as_human_speed %]
                    <span class="data">[% torrent.down_rate %]</span>
                </td>
                <td class="up_speed digit">
                    [% torrent.up_rate.as_human_speed %]
                    <span class="data">[% torrent.up_rate %]</span>
                </td>
                [% SET class = ['rate', 'digit'] %]
                [% IF torrent.ratio >= 1.0; class.push('positive');
                   ELSE; class.push('negative');
                   END %]
                <td class="[% class.join(' ') %]">
                    [% torrent.ratio %]
                </td>
            </tr>
    [% END %]
    </tbody>
    </table>
</div>

</form>
